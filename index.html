<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jadwal Khotib - MASJID PT. UNIMITRA KHARISMA</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Playfair+Display:wght@700&family=Orbitron:wght@500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #10b981; 
            --emerald-glow: linear-gradient(to bottom, #ffffff 0%, #34d399 50%, #059669 100%);
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #064e3b 100%);
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-main: #ffffff;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-gradient);
            background-attachment: fixed;
            color: var(--text-main);
            margin: 0;
            padding: 40px 20px;
            display: flex; flex-direction: column; align-items: center; min-height: 100vh;
        }

        .container { width: 100%; max-width: 1100px; }

        header { text-align: center; margin-bottom: 40px; }
        header h2 { margin: 0; font-weight: 400; letter-spacing: 6px; text-transform: uppercase; font-size: 0.8rem; color: var(--primary); text-shadow: 0 0 10px rgba(16, 185, 129, 0.3); }
        header h1 { margin: 10px 0; font-family: 'Playfair Display', serif; font-weight: 700; font-size: 3rem; background: var(--emerald-glow); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 15px rgba(52, 211, 153, 0.4)); letter-spacing: 1px; }

        .title-divider { display: flex; align-items: center; justify-content: center; gap: 15px; margin-top: 5px; margin-bottom: 20px; }
        .line { height: 1px; width: 80px; background: linear-gradient(to right, transparent, var(--primary), transparent); }
        .dot { height: 5px; width: 5px; background: var(--primary); border-radius: 50%; box-shadow: 0 0 10px var(--primary); }

        /* JAM DIGITAL */
        .digital-clock-wrapper { text-align: center; margin: 10px 0 25px 0; }
        .clock-time { font-family: 'Trajan Pro', sans-serif; font-size: 2.8rem; color: #fff; text-shadow: 0 0 20px rgba(16, 185, 129, 0.6); margin: 0; }
        .clock-date { font-size: 0.9rem; color: var(--primary); letter-spacing: 2px; text-transform: uppercase; font-weight: 600; margin-top: 5px; }

        /* JADWAL SHOLAT */
        .prayer-times {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin: 0 auto 30px auto;
            max-width: 750px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            border: 1px solid var(--glass-border);
        }
        .prayer-item { text-align: center; }
        .prayer-name { font-size: 0.65rem; color: var(--primary); text-transform: uppercase; font-weight: 700; margin-bottom: 4px; }
        .prayer-time { font-size: 1.2rem; font-weight: 600; color: #fff; }

        .card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 35px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6);
            margin-bottom: 30px;
        }

        .search-wrapper { display: flex; justify-content: center; margin-bottom: 25px; }
        .main-search {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--glass-border);
            padding: 14px 25px;
            border-radius: 50px;
            color: white;
            width: 100%;
            max-width: 500px;
            outline: none;
            text-align: center;
            transition: 0.3s;
        }
        .main-search:focus { border-color: var(--primary); background: rgba(16, 185, 129, 0.05); }

        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .input-group { display: flex; flex-direction: column; text-align: center; }
        label { font-size: 0.65rem; font-weight: 700; color: var(--primary); margin-bottom: 8px; text-transform: uppercase; }
        input { background: rgba(255, 255, 255, 0.05); border: 1px solid var(--glass-border); padding: 12px; border-radius: 12px; color: white; text-align: center; outline: none; transition: 0.3s; }
        input:focus { border-color: var(--primary); background: rgba(255, 255, 255, 0.1); }

        .btn-add { background: var(--primary); color: white; border: none; padding: 16px; border-radius: 12px; font-weight: 700; cursor: pointer; width: 100%; text-transform: uppercase; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); transition: 0.3s; }
        .btn-add:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4); }

        .table-container { background: var(--glass); border: 1px solid var(--glass-border); border-radius: 20px; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; min-width: 900px; }
        th { background: rgba(16, 185, 129, 0.1); padding: 20px; font-size: 0.75rem; color: var(--primary); text-align: center; }
        td { padding: 16px; font-size: 0.85rem; text-align: center; border-bottom: 1px solid rgba(255, 255, 255, 0.03); }
        .khotib-name { color: var(--primary); font-weight: 600; }
        
        .action-btns { display: flex; gap: 8px; justify-content: center; }
        .btn-edit { background: none; color: #fbbf24; border: 1px solid rgba(251, 191, 36, 0.3); padding: 5px 12px; border-radius: 6px; cursor: pointer; }
        .btn-delete { background: none; color: #f87171; border: 1px solid rgba(248, 113, 113, 0.3); padding: 5px 12px; border-radius: 6px; cursor: pointer; }

        @media (max-width: 600px) {
            .prayer-times { grid-template-columns: repeat(3, 1fr); }
            header h1 { font-size: 1.8rem; }
            .clock-time { font-size: 2rem; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h2>JADWAL KHOTIB</h2>
        <h1>MASJID PT. UNIMITRA KHARISMA</h1>
        <div class="title-divider">
            <div class="line"></div>
            <div class="dot"></div>
            <div class="line"></div>
        </div>
    </header>

    <div class="card">
        <div class="search-wrapper">
            <input type="text" id="globalSearch" class="main-search" 
                   placeholder="Cari Tanggal, Bulan, atau Nama Khotib..." onkeyup="manualSearch()">
        </div>

        <div class="digital-clock-wrapper">
            <div class="clock-time" id="clock">00:00:00</div>
            <div class="clock-date" id="date">Memuat Tanggal...</div>
        </div>

        <div class="prayer-times" id="jadwalSholat">
            <div class="prayer-item"><div class="prayer-name">Subuh</div><div class="prayer-time" id="subuh">-:-</div></div>
            <div class="prayer-item"><div class="prayer-name">Dzuhur</div><div class="prayer-time" id="dzuhur">-:-</div></div>
            <div class="prayer-item"><div class="prayer-name">Ashar</div><div class="prayer-time" id="ashar">-:-</div></div>
            <div class="prayer-item"><div class="prayer-name">Maghrib</div><div class="prayer-time" id="maghrib">-:-</div></div>
            <div class="prayer-item"><div class="prayer-name">Isya</div><div class="prayer-time" id="isya">-:-</div></div>
            <div class="prayer-item"><div class="prayer-name">Imsak</div><div class="prayer-time" id="imsak">-:-</div></div>
        </div>
        
        <div class="form-grid">
            <input type="hidden" id="editIndex" value="-1">
            <div class="input-group"><label>Tanggal</label><input type="number" id="tgl" placeholder="00"></div>
            <div class="input-group"><label>Bulan</label><input type="text" id="bln" placeholder="Bulan"></div>
            <div class="input-group"><label>Nama Khotib</label><input type="text" id="khotib" placeholder="Nama Ustadz"></div>
            <div class="input-group"><label>Alamat</label><input type="text" id="alamat" placeholder="Asal"></div>
            <div class="input-group"><label>No HP</label><input type="text" id="hp" placeholder="WhatsApp"></div>
            <div class="input-group"><label>Muadzin</label><input type="text" id="muadzin" placeholder="Nama"></div>
        </div>
        <button id="submitBtn" class="btn-add" onclick="simpanData()">Simpan Jadwal</button>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>NO</th><th>TANGGAL</th><th>BULAN</th><th>KHOTIB</th><th>ALAMAT</th><th>NO WA</th><th>MUADZIN</th><th>AKSI</th>
                </tr>
            </thead>
            <tbody id="khotibTableBody"></tbody>
        </table>
    </div>
</div>

<script>
    // --- FUNGSI JAM DIGITAL ---
    function updateClock() {
        const now = new Date();
        const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
        const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
        
        const h = String(now.getHours()).padStart(2, '0');
        const m = String(now.getMinutes()).padStart(2, '0');
        const s = String(now.getSeconds()).padStart(2, '0');
        
        document.getElementById('clock').innerText = `${h}:${m}:${s}`;
        document.getElementById('date').innerText = `${days[now.getDay()]}, ${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()}`;
    }
    setInterval(updateClock, 1000);
    updateClock();

    // --- FUNGSI JADWAL SHOLAT API ---
    async function getJadwalSholat() {
        try {
            const response = await fetch('https://api.aladhan.com/v1/timingsByCity?city=Jakarta&country=Indonesia&method=11');
            const data = await response.json();
            const timings = data.data.timings;
            document.getElementById('subuh').innerText = timings.Fajr;
            document.getElementById('dzuhur').innerText = timings.Dhuhr;
            document.getElementById('ashar').innerText = timings.Asr;
            document.getElementById('maghrib').innerText = timings.Maghrib;
            document.getElementById('isya').innerText = timings.Isha;
            document.getElementById('imsak').innerText = timings.Imsak;
        } catch (error) { console.log("Gagal memuat jadwal sholat"); }
    }
    getJadwalSholat();

    // --- LOGIKA MANAJEMEN DATA ---
    let dataKhotib = JSON.parse(localStorage.getItem('unimitra_khotib_v9')) || [];

    function manualSearch() {
        const query = document.getElementById('globalSearch').value.toLowerCase();
        const filtered = dataKhotib.filter(item => {
            return item.tgl.toString().includes(query) || 
                   item.bln.toLowerCase().includes(query) || 
                   item.khotib.toLowerCase().includes(query)
        });
        renderTable(filtered);
    }

    function renderTable(filterData = null) {
        const tableBody = document.getElementById('khotibTableBody');
        tableBody.innerHTML = '';
        const displayData = filterData || dataKhotib;
        
        displayData.forEach((item, index) => {
            const originalIndex = dataKhotib.indexOf(item);
            tableBody.innerHTML += `<tr>
                <td>${index + 1}</td>
                <td style="font-weight: 700;">${item.tgl}</td>
                <td>${item.bln}</td>
                <td class="khotib-name">${item.khotib}</td>
                <td>${item.alamat}</td>
                <td>${item.hp}</td>
                <td>${item.muadzin}</td>
                <td>
                    <div class="action-btns">
                        <button class="btn-edit" onclick="editData(${originalIndex})">Edit</button>
                        <button class="btn-delete" onclick="hapusData(${originalIndex})">Hapus</button>
                    </div>
                </td>
            </tr>`;
        });
    }

    function editData(index) {
        const item = dataKhotib[index];
        document.getElementById('editIndex').value = index;
        document.getElementById('tgl').value = item.tgl;
        document.getElementById('bln').value = item.bln;
        document.getElementById('khotib').value = item.khotib;
        document.getElementById('alamat').value = item.alamat;
        document.getElementById('hp').value = item.hp;
        document.getElementById('muadzin').value = item.muadzin;
        document.getElementById('submitBtn').innerText = "Perbarui Data";
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function simpanData() {
        const index = parseInt(document.getElementById('editIndex').value);
        const data = {
            tgl: document.getElementById('tgl').value,
            bln: document.getElementById('bln').value,
            khotib: document.getElementById('khotib').value,
            alamat: document.getElementById('alamat').value,
            hp: document.getElementById('hp').value,
            muadzin: document.getElementById('muadzin').value
        };

        if(!data.tgl || !data.khotib) return alert("Data belum lengkap!");

        if (index > -1) dataKhotib[index] = data;
        else dataKhotib.push(data);

        localStorage.setItem('unimitra_khotib_v9', JSON.stringify(dataKhotib));
        location.reload();
    }

    function hapusData(index) {
        if(confirm("Hapus data ini?")) {
            dataKhotib.splice(index, 1);
            localStorage.setItem('unimitra_khotib_v9', JSON.stringify(dataKhotib));
            renderTable();
        }
    }

    renderTable();
</script>

</body>
</html>
